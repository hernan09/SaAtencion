<ion-header>

	<ion-navbar hideBackButton>
	    <ion-buttons left>
	    	<button left menuToggle="left" class="urgIcon">
	    		<ion-icon name="menu"></ion-icon>
	    	</button>
	    </ion-buttons>
	    <ion-title>
	    	URG
	    </ion-title>
	    <ion-buttons right>
	    	<a href="tel:{{telefono}}" (click)="nextPhoneNumber()">
			    <button right class="urgIcon">
			    	<ion-icon name="call"></ion-icon>
			    </button>
			</a>
		</ion-buttons>
	</ion-navbar>

	<ion-toolbar [ngClass]="{'subHidden': !showSubHeader}">
		<ion-title *ngIf="!showHomeIcon">{{alertas[0].title}}</ion-title>
		<ion-title *ngIf="showHomeIcon">Inicio</ion-title>
	</ion-toolbar>

</ion-header>


<ion-content padding [ngClass]="{'subHiddenMargin': !showSubHeader}">

	<div *ngFor="let alerta of alertas" class="alerta-list">

		<div *ngIf="alerta.step == 5 && alerta.visible" class="alerta-item-1">
			<div class="imgCall"></div>
			<div class="label">
				{{alerta.estado.label}}
				<button ion-button icon-left class="urg-button-lightgreen-call"
					(click)="initVideoconsulta(alerta.estado.cid, alerta.estado.dni)" [disabled]="isCIDBlocked">
					<ion-icon name="ion-ios-videocam"></ion-icon>
					Ingresar
				</button>
			</div>
		</div>

		<div *ngIf="alerta.step == 4 && alerta.visible" class="alerta-item-poll" id="encuetasItem">

			<div *ngIf="!alerta.poll.thanks" >
				<ion-icon (click)="sayThanks()" name="close" class="poll-exit" ></ion-icon>

				<div class="poll-question">
					{{alerta.poll.question}}
				</div>

				<div *ngFor="let o of poll_options" (click)="rate(o.value)"
					[ngClass]="{'selected': alerta.poll.rate == o.value}"
					class="poll-option {{ o.class }}" >
					<div><div class="poll-option-img"></div></div>
					<div>{{ o.label }}</div>
				</div>

				<textarea class="poll-comment" placeholder="Dejanos tu comentario" [(ngModel)]='alerta.poll.comment'></textarea>

				<button ion-button full class="urg-button-blue"
					(click)="sendPoll()">
					Enviar
				</button>

			</div>

			<div *ngIf="alerta.poll.thanks" >
				<div class="logo"></div>
				<div class="poll-msg">
			    	<div *ngIf="answered">¡MUCHAS GRACIAS POR AYUDARNOS A MEJORAR!</div>
			    	<div *ngIf="!answered">¡MUCHAS GRACIAS POR UTILIZAR NUESTROS SERVICIOS!</div>
				</div>
			</div>
		</div>


		<div *ngIf="alerta.step == 3 && alerta.visible" class="alerta-item-visita">
			<div class="visita-estado" [ngClass]="{'estado-ok': alerta.estado.ok, 'estado-nok': !alerta.estado.ok}">{{alerta.estado.status}}</div>
			<div *ngIf="!alerta.doctor.foto"class="visita-imagen" [ngClass]="{'img-nok': !alerta.estado.ok}"></div>	
			<div *ngIf="alerta.doctor.foto">		
			<img class="visita-imagen-medico" [src]="alerta.doctor.foto"><img>
			<!-- <img class="visita-imagen-medico" src="https://storage.googleapis.com/urg-movil-storage/foto-medico-1.jpeg"><img>			 -->
			</div>
			<div class="visita-info">
				<div>
					<div class="visita-info-profesional">Médico asignado</div>
					<div class="visita-info-nombre" *ngIf="alerta.doctor.nombre">{{alerta.doctor.nombre}}</div>
					<div class="visita-info-especialidad" *ngIf="alerta.doctor.especialidad">{{alerta.doctor.especialidad}}</div>
					<div class="visita-info-matricula" *ngIf="alerta.doctor.matricula">Matrícula: {{alerta.doctor.matricula}}</div>
				</div>
			</div>
			<div class="visita-hora">
				<div class="visita-hora-reloj"></div>
				<div class="visita-hora-label">
					<div [ngClass]="{'estado-ok': alerta.estado.ok, 'estado-nok': !alerta.estado.ok}">{{alerta.estado.label}}</div>
				</div>
				<div class="visita-hora-tiempo">
					<div [ngClass]="{'estado-ok': alerta.estado.ok, 'estado-nok': !alerta.estado.ok}">{{alerta.estado.hora}}</div>
				</div>
			</div>
		</div>


		<div *ngIf="alerta.step == 2 && alerta.visible" class="alerta-item-prearribo">
			<div>Mientras que arriba el médico, seguí estas recomendaciones:</div>
			<div class="instructions">INSTRUCCIONES DE PREARRIBO</div>
			<div>{{alerta.prearribo.condicion}}</div>
			<div *ngFor="let consejo of alerta.prearribo.consejos">{{consejo}}</div>
		</div>


		<div *ngIf="alerta.step == 1 && alerta.visible" class="alerta-item-1">
			<div class="img"><!--<div class="small badge">1</div>--></div>
			<div class="label">
				{{alerta.asignacion}}
			</div>
		</div>

	</div>


	<div *ngIf="showHomeIcon" class="alerta-item-none">
		<div class="img"><!--<div class="badge">0</div>--></div>
		<div class="label">
			No tenés ninguna solicitud pendiente de médico a domicilio
		</div>
	</div>

	<button *ngIf="videoconsulta" ion-button full icon-start class="urg-button-blue"
		(click)="initVideoconsulta()">
		<ion-icon name="video"></ion-icon>
		Comenzar Videoconsulta
	</button>

</ion-content>

<ion-footer id="homeFooter">
	<a href="tel:{{telefono}}" (click)="nextPhoneNumber()">
		<button ion-button full icon-start class="urg-button-lightgreen">
			<ion-icon name="call"></ion-icon>
			Solicitar médico
		</button>
	</a>
</ion-footer>
